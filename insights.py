from __future__ import annotations
"""
Bridge - Insights & Market Commentary Module
Thought pieces and thematic analysis from Buckingham Research
"""

INSIGHTS = [
    {
        "id": "insight-001",
        "title": "MPS Selection: A Flawed Formula?",
        "category": "Thematic Analysis",
        "date": "2026-01-10",
        "author": "Bridge Research",
        "summary": "No correlation exists between past and future MPS performance. Selecting top performers from the past three years would have resulted in below-average returns going forward.",
        "content": "We have all seen articles highlighting the highest returning \u2018balanced\u2019 MPS portfolios over the past three years. Indeed, it is no surprise considering performance is typically the top priority when advisers select an MPS provider.\n\n**No correlation between past and future performance**\n\nHowever, does this approach to selecting an MPS provider work? Do the top performers over the past, say, three years tend to outperform going forward? The data suggests the answer is \u2018no, they don\u2019t\u2019.\n\nEach dot in our analysis represents a balanced MPS portfolio, defined as an MPS portfolio sitting in Morningstar\u2019s 40-60% equity category. The placement of the dot is determined by where each balanced MPS portfolio ranked relative to its peers in two consecutive three-year periods.\n\nZooming out, we see no correlation between past and future performance, as the dots appear randomly distributed. This trend holds true over longer discrete periods.\n\n**Selecting past top performers would have resulted in below-average returns**\n\nAnother way we can assess the effectiveness of picking an MPS provider based on past performance is to back-test the returns of this method, compared to what the returns were for the average balanced MPS.\n\nIf you followed the approach of selecting the best performer from the preceding three years, you would have achieved below-average returns over the nine-year period from 31st Dec 2015 to 31st Dec 2024.\n\n**Understand the nuances to prevent making mistakes with your MPS selection**\n\nThere are several reasons why performance of an MPS can revert so emphatically, which is why understanding their return drivers in greater depth is vital.\n\nConcentrated exposure to certain factor(s) \u2013 this factor may have outperformed for a period, but the MPS retained exposure as it started to underperform.\n\nAsset allocation at the edge of risk level range \u2013 in a risk level where equity exposure varies 20% (e.g. 40-60% category), relative performance is largely driven by where they sit within this range.\n\nDifferent approach to SAA \u2013 different processes and objectives will result in meaningfully different SAAs and therefore return profiles.\n\n**How Bridge can help**\n\nWe have developed Bridge for the very reason to help advisers understand the MPS solutions they utilise in greater depth \u2013 and to do so from an independent perspective.",
        "tags": ["mps-selection", "performance", "back-testing", "consumer-duty"],
        "read_time_minutes": 6,
    },
    {
        "id": "insight-002",
        "title": "Putting MPS Management Fees into Perspective",
        "category": "Thematic Analysis",
        "date": "2026-01-24",
        "author": "Bridge Research",
        "summary": "MPS fees make up a small fraction of long-term client returns. Understanding the depth of the investment process matters more than headline cost comparisons.",
        "content": "I understand why fees have become an increasingly important factor when it comes to selecting an MPS provider. The fee you save a client is tangible and easily quantifiable as \u2018value-add\u2019.\n\n**MPS fees make up a fraction of clients\u2019 returns over the long-term**\n\nOver the last 10 years, the average balanced MPS portfolio has generated an annualised net return of 4.75%. Of those MPS portfolios that have been going for that long, the average of their current MPS management fee is 0.18%.\n\nIf all MPS portfolios were built and managed in the same way, then prioritising cost would make sense. However, they are unique, and client outcomes vary significantly. The highest annualised net returns were 6.0%, whilst the lowest were 3.8% \u2013 a difference of 2.2% annualised.\n\n**Fees should partially reflect the depth of the investment process**\n\nI would also argue that management fees should take the providers\u2019 investment process into account. Although that investment process diagram will look broadly the same for any MPS provider, what is going on underneath the bonnet is where they will start to differ significantly.\n\nIt\u2019s sensible to put this depth into context with the management fee. Just because a provider has a thorough investment process, it doesn\u2019t automatically justify paying higher fees. They also must ensure they are adding value by their decisions.\n\nAt Bridge, we provide the tools to make this evaluation, allowing advisers to truly understand the value of such decisions.",
        "tags": ["fees", "cost-analysis", "investment-process", "value-for-money"],
        "read_time_minutes": 5,
    },
    {
        "id": "insight-003",
        "title": "Active Fund Performance Isn\u2019t Necessarily the Problem",
        "category": "Thematic Analysis",
        "date": "2026-02-03",
        "author": "Bridge Research",
        "summary": "Investor returns often lag fund returns due to poor timing of buy/sell decisions. Understanding this gap is crucial for assessing MPS provider fund selection skill.",
        "content": "Very often we read about active fund underperformance, often missing a separate but crucial point: investors\u2019 actual returns are also shaped by the timing of their decisions to buy and sell funds.\n\n**Mind the Gap**\n\nMorningstar\u2019s Mind the Gap study captures this reality clearly. By comparing a fund\u2019s total return with the returns actually experienced by investors, the analysis reveals a persistent shortfall. Investors earned roughly 6.3% per year over a 10-year period, compared with 7.3% for the average fund \u2013 a gap of approximately 1.1% per year.\n\n**Observing Flow Data Explains the Gap**\n\nThe answer lies in behavioural biases and return-chasing behaviour. When performance is strong, investors pile in. When it falters, they start to sell out \u2013 effectively buy high, sell low.\n\n**Why This is Paramount for Assessing MPS Providers**\n\nIf you\u2019re outsourcing investment management to MPS providers, it\u2019s vital to dig deeper than high level performance numbers alone. We\u2019ve built an analytical framework to assess how underlying funds perform versus benchmarks, and whether the timing of fund selection changes adds or detracts from performance.\n\nIn today\u2019s Consumer Duty environment, advisers must evidence that their recommended solutions deliver value for money.",
        "tags": ["active-vs-passive", "fund-selection", "behavioural-finance", "mind-the-gap"],
        "read_time_minutes": 5,
    },
    {
        "id": "insight-004",
        "title": "The Global vs UK Story in Multi Asset Portfolios",
        "category": "Thematic Analysis",
        "date": "2026-02-07",
        "author": "Bridge Research",
        "summary": "Global outperformance over UK extends beyond equities into fixed income, creating a powerful tailwind for globally-biased MPS propositions.",
        "content": "The outperformance of global versus UK equities has been widely discussed. Clearly, global equities have substantially outpaced their UK counterparts in recent years.\n\n**Global fixed income has also outperformed**\n\nHowever, the story doesn\u2019t stop at equities. Global fixed income has also materially outperformed UK fixed income over the past few years. This outperformance has not been driven by higher credit risk, but by duration effects, currency tailwinds, and a broader opportunity set.\n\n**Impact on MPS performance comparisons**\n\nThe combined effect has created a powerful tailwind for global portfolios, explaining why many globally biased MPS propositions have found themselves towards the top of performance tables.\n\nHowever, high-level MPS returns can be misleading without context. Often comparisons are made at the surface level, without appreciating how much return dispersion comes down to geographic allocation differences rather than genuine skill.\n\nAdvisers need to look deeper than performance quartiles to understand the true drivers of return and risk.",
        "tags": ["uk-vs-global", "asset-allocation", "fixed-income", "performance-attribution"],
        "read_time_minutes": 5,
    },
    {
        "id": "insight-005",
        "title": "Why MPS is Preferred Over Multi-Asset Funds",
        "category": "Thematic Analysis",
        "date": "2026-02-10",
        "author": "Bridge Research",
        "summary": "MPS has overtaken multi-asset funds as the default solution for UK advisers, driven by superior service, converging costs, and regulatory alignment under Consumer Duty.",
        "content": "Over the past five years there has been a quiet revolution in the way UK advisers construct client portfolios. Today, Model Portfolio Services have overtaken multi-asset funds as the primary outsourced investment solution.\n\n**More than just models \u2013 the service imperative**\n\nIn a 2024 IFA Magazine poll, 67.7% of advisers said they already use MPS, and 89.9% highlighted service levels as the most important feature. The FCA\u2019s Consumer Duty requires advisers to evidence ongoing suitability and value for money.\n\n**Costs have converged**\n\nHistorically, MPS fees were much higher than multi-asset funds. The median MPS management charge is now around 0.15-0.20%.\n\n**Tax wrappers and customised control**\n\nThe CGT issue is largely irrelevant when 90% of gross sales into models are via ISAs and pensions. Customisation is another selling point \u2013 advisers can build white-labelled versions.\n\n**Balancing service and investment features**\n\nWhat is clear is that the \u201cS\u201d in Managed Portfolio Services now stands for far more than just a collection of funds. It represents a partnership.",
        "tags": ["mps-vs-maf", "multi-asset", "service", "consumer-duty", "cost-analysis"],
        "read_time_minutes": 7,
    },
    {
        "id": "insight-006",
        "title": "Consumer Duty and MPS: Why Due Diligence Alone Isn\u2019t Enough",
        "category": "Regulatory",
        "date": "2026-02-14",
        "author": "Bridge Research",
        "summary": "Under Consumer Duty, outsourcing to an MPS doesn\u2019t mean outsourcing responsibility. Advisers need genuine, outcome-focused research beyond tick-box due diligence.",
        "content": "Outsourcing investment management to MPS has become the default for many advisory firms. But under the Consumer Duty, outsourcing does not mean outsourcing responsibility.\n\n**Due diligence checks the provider. Research tests the solution.**\n\nMost firms have well-established due diligence frameworks. However, due diligence primarily answers: \u201cIs this provider credible and well-run?\u201d Consumer Duty requires a different question: \u201cIs this solution appropriate and delivering good outcomes for my clients?\u201d\n\n**What Consumer Duty actually changes**\n\nFG22/5 makes it clear that firms remain accountable for customer outcomes throughout the distribution chain. In practice, that means evidencing: why a particular MPS was selected, which client segments it is suitable for, how it delivers value, and how outcomes are monitored.\n\n**Ongoing monitoring processes are a requirement**\n\nMonitoring should cover whether portfolios remain aligned to risk profiles, whether performance is consistent with expectations, whether provider changes remain appropriate, and whether clients receive fair value.\n\n**How Bridge can help**\n\nBridge provides independent research, clear insight into drivers of performance, risk and value, ongoing monitoring aligned with CIP reviews, and structured outputs that support Consumer Duty evidence requirements.",
        "tags": ["consumer-duty", "regulation", "fca", "due-diligence", "oversight"],
        "read_time_minutes": 6,
    },
]


def get_all_insights():
    return sorted(INSIGHTS, key=lambda x: x["date"], reverse=True)

def get_insight_by_id(insight_id):
    return next((i for i in INSIGHTS if i["id"] == insight_id), None)

def get_insights_by_category(category):
    return sorted(
        [i for i in INSIGHTS if i["category"].lower() == category.lower()],
        key=lambda x: x["date"], reverse=True
    )

def get_insight_categories():
    return list(set(i["category"] for i in INSIGHTS))

def search_insights(query):
    query_lower = query.lower()
    results = []
    for insight in INSIGHTS:
        if (query_lower in insight["title"].lower() or
            query_lower in insight["summary"].lower() or
            any(query_lower in tag for tag in insight["tags"])):
            results.append(insight)
    return sorted(results, key=lambda x: x["date"], reverse=True)
